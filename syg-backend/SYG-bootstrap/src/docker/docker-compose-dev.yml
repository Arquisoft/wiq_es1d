version: '3.3'

services:
  syg-backend:
    container_name: syg-backend
    build:
      context: ../../../
      dockerfile: ./SYG-bootstrap/src/docker/backend.Dockerfile
    ports:
      - 8080:8080
    networks:
      syg:
        aliases:
          - syg-backend
      
  syg-db:
    container_name: syg-db
    #image: mysql:latest
    build:
      context: ../../../
      dockerfile: ./SYG-bootstrap/src/docker/database-mysql.Dockerfile
    ports:
      - 3306:3306
    volumes:
      - ../sql/scheme.sql:/docker-entrypoint-initdb.d/init.sql
    restart: always
    networks:
      syg:
        aliases:
          - syg-db
          
  syg-keycloak:
    container_name: syg-keycloak
    image: quay.io/keycloak/keycloak:24.0.1
    ports:
      - 8090:8080
    volumes:
      - ./keycloak/imports:/tmp/import
    environment:
      - KEYCLOAK_ADMIN=admin
      - KEYCLOAK_ADMIN_PASSWORD=admin
      - KEYCLOAK_IMPORT=/tmp/import/realm-export.json
    command:
      - start-dev
    networks:
      syg:
        aliases:
          - syg-keycloak

networks:
    syg:
      driver: bridge